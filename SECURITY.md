# –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å Easy Panel

## üîí –ó–∞—â–∏—Ç–∞ –¥–∞–Ω–Ω—ã—Ö

### 1. –ü–∞—Ä–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **–ú–µ—Ç–æ–¥**: BCrypt —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ (has_secure_password)
- **–°—Ç–æ–∏–º–æ—Å—Ç—å**: 12 —Ä–∞—É–Ω–¥–æ–≤ (cost factor)
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –ó–∞—â–∏—â–µ–Ω—ã
- **–ü—Ä–∏–º–µ—Ä —Ö–µ—à–∞**: `$2a$12$JwePKAasKGByKo82ouESTOqJwdgT.lGikEdQnIkDKGNLcp7DHlQA...`

### 2. Refresh Tokens
- **–ú–µ—Ç–æ–¥**: Rails Active Record Encryption
- **–ê–ª–≥–æ—Ä–∏—Ç–º**: AES-GCM
- **–î–µ—Ç–µ—Ä–º–∏–Ω–∏—Å—Ç–∏—á–Ω–æ—Å—Ç—å**: –ù–µ–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Å—Ç–∏—á–µ—Å–∫–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ (–±–æ–ª–µ–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ)
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ã –≤ –ë–î
- **–ü—Ä–∏–º–µ—Ä –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ç–æ–∫–µ–Ω–∞**:
  ```json
  {
    "p": "onaVUtWU0KoNVJ0fJer8o+hdkwQ5YMqmjdLW3OzbJiZw...",
    "h": {
      "iv": "...",
      "at": "..."
    }
  }
  ```

### 3. IP –∞–¥—Ä–µ—Å–∞
- **–ú–µ—Ç–æ–¥**: Rails Active Record Encryption (AES-GCM)
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ã –≤ –ë–î
- **–ü—Ä–∏–º–µ—Ä**: `192.168.65.1` ‚Üí `{"p":"Qm5a89NQl83q7HFx","h":{"iv":"R08K+0Op3AfiIVil","at":"..."}}`

### 4. Device Info (User-Agent)
- **–ú–µ—Ç–æ–¥**: Rails Active Record Encryption (AES-GCM)
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ã –≤ –ë–î
- **–ü—Ä–∏–º–µ—Ä**: `curl/8.7.1` ‚Üí `{"p":"kSmkkCO57DDBnw==","h":{"iv":"m68keO3JMGsF2PiT","at":"..."}}`

## üîë JWT –¢–æ–∫–µ–Ω—ã

### Access Token (24 —á–∞—Å–∞)
- –°–æ–¥–µ—Ä–∂–∏—Ç: `user_id`, `type: 'access'`, `exp`, `iat`
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è: –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ API –∑–∞–ø—Ä–æ—Å–æ–≤
- –ü–µ—Ä–µ–¥–∞–µ—Ç—Å—è: –í –∑–∞–≥–æ–ª–æ–≤–∫–µ `Authorization: Bearer <token>`
- –ü—Ä–æ–≤–µ—Ä–∫–∞: Middleware –Ω–∞ –∫–∞–∂–¥–æ–º –∑–∞—â–∏—â–µ–Ω–Ω–æ–º endpoint

### Refresh Token (30 –¥–Ω–µ–π)
- –°–æ–¥–µ—Ä–∂–∏—Ç: `refresh_token_id`, `type: 'refresh'`, `exp`, `iat`
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è: –û–±–Ω–æ–≤–ª–µ–Ω–∏—è access token
- –•—Ä–∞–Ω–µ–Ω–∏–µ: –ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω –≤ –ë–î
- –û—Ç–∑—ã–≤: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ logout –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏

## üõ°Ô∏è –ó–∞—â–∏—Ç–∞ API

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
–í—Å–µ endpoints —Ç—Ä–µ–±—É—é—Ç –≤–∞–ª–∏–¥–Ω—ã–π access token, –∫—Ä–æ–º–µ:
- `POST /auth/login`
- `POST /auth/register`
- `POST /auth/refresh`

### –ü—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
1. **–¢–∏–ø —Ç–æ–∫–µ–Ω–∞**: –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —á—Ç–æ –¥–ª—è API –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∏–º–µ–Ω–Ω–æ access token
2. **–°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è**: JWT –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç expiration
3. **–í–∞–ª–∏–¥–Ω–æ—Å—Ç—å refresh token**: –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —á—Ç–æ —Ç–æ–∫–µ–Ω –Ω–µ –æ—Ç–æ–∑–≤–∞–Ω –∏ –Ω–µ –∏—Å—Ç–µ–∫
4. **User existence**: –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

## üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤

### Frontend (React)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞ 1 —á–∞—Å –¥–æ –∏—Å—Ç–µ—á–µ–Ω–∏—è
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π refresh –ø—Ä–∏ 401 –æ—à–∏–±–∫–µ
- –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ /login –ø—Ä–∏ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –æ–±–Ω–æ–≤–∏—Ç—å

### Backend (Rails)
- –°—Ç–∞—Ä—ã–π refresh token –æ—Ç–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏
- –ù–æ–≤–∞—è –ø–∞—Ä–∞ —Ç–æ–∫–µ–Ω–æ–≤ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è
- –ò—Å—Ç–æ—Ä–∏—è –≤—Å–µ—Ö refresh —Ç–æ–∫–µ–Ω–æ–≤ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è

## üìä –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–µ—Å—Å–∏—è—Ö

–î–ª—è –∫–∞–∂–¥–æ–≥–æ refresh token —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è (–≤ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–º –≤–∏–¥–µ):
- IP –∞–¥—Ä–µ—Å –∫–ª–∏–µ–Ω—Ç–∞
- User-Agent (–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±—Ä–∞—É–∑–µ—Ä–µ/–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏)
- –í—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è
- –í—Ä–µ–º—è –∏—Å—Ç–µ—á–µ–Ω–∏—è
- –°—Ç–∞—Ç—É—Å (–∞–∫—Ç–∏–≤–µ–Ω/–æ—Ç–æ–∑–≤–∞–Ω)

## ‚öôÔ∏è –ö–ª—é—á–∏ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è

### Development
```ruby
active_record_encryption:
  primary_key: a0SIgOxb8izHTqNosRdtXwaDHUHDKzq2
  deterministic_key: aWvZgehZjfIUWIFv8alVfjhu4iY9JONz
  key_derivation_salt: Y400MKSv4KFCdvKHIJZGOjEBwLEovPHW
```

‚ö†Ô∏è **–í–ê–ñ–ù–û**: –í production –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
- `ACTIVE_RECORD_ENCRYPTION_PRIMARY_KEY`
- `ACTIVE_RECORD_ENCRYPTION_DETERMINISTIC_KEY`
- `ACTIVE_RECORD_ENCRYPTION_KEY_DERIVATION_SALT`

## üöÄ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è production

1. **HTTPS only**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–ª—å–∫–æ HTTPS –≤ production
2. **Secure cookies**: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ secure –∏ httpOnly —Ñ–ª–∞–≥–∏ –¥–ª—è cookies
3. **Rate limiting**: –î–æ–±–∞–≤—å—Ç–µ rate limiting –¥–ª—è auth endpoints
4. **CORS**: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Å—Ç—Ä–æ–≥—É—é –ø–æ–ª–∏—Ç–∏–∫—É CORS
5. **Monitoring**: –û—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å (–º–Ω–æ–∂–µ—Å—Ç–≤–æ failed login)
6. **Rotation**: –†–µ–≥—É–ª—è—Ä–Ω–æ –º–µ–Ω—è–π—Ç–µ encryption keys
7. **Backup**: –•—Ä–∞–Ω–∏—Ç–µ encrypted backups encryption keys –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º –º–µ—Å—Ç–µ

## üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

- ‚úÖ Failed login attempts –ª–æ–≥–∏—Ä—É—é—Ç—Å—è
- ‚úÖ Token refresh –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è
- ‚úÖ JWT decode errors –ª–æ–≥–∏—Ä—É—é—Ç—Å—è
- ‚ùå –£—Å–ø–µ—à–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ù–ï –ª–æ–≥–∏—Ä—É—é—Ç —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑ —Ç–æ–∫–µ–Ω–∞
curl http://localhost:5001/api/v1/auth/me
# –û—Ç–≤–µ—Ç: {"error": "–¢–æ–∫–µ–Ω –Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω"}

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–º —Ç–æ–∫–µ–Ω–æ–º
curl -H "Authorization: Bearer invalid" http://localhost:5001/api/v1/auth/me
# –û—Ç–≤–µ—Ç: {"error": "–ù–µ–≤–∞–ª–∏–¥–Ω—ã–π —Ç–æ–∫–µ–Ω"}

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å refresh token –≤–º–µ—Å—Ç–æ access
curl -H "Authorization: Bearer <refresh_token>" http://localhost:5001/api/v1/auth/me
# –û—Ç–≤–µ—Ç: {"error": "–¢—Ä–µ–±—É–µ—Ç—Å—è access token"}
```

## ‚úÖ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º

- ‚úÖ OWASP Top 10 (–∑–∞—â–∏—Ç–∞ –æ—Ç –æ—Å–Ω–æ–≤–Ω—ã—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π)
- ‚úÖ RFC 7519 (JWT)
- ‚úÖ GDPR compliant (—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö)
- ‚úÖ PCI DSS recommendations (–∑–∞—â–∏—Ç–∞ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö)
